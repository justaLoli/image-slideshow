<!DOCTYPE html>
<html>
<head>
<title>图片幻灯片</title>
<meta charset="UTF-8">
<style>
#image-area {
  width: 800px;
  height: 600px;
  background-color: #eee;
  display: flex; /* 使用Flexbox布局 */
  justify-content: center; /* 水平居中 */
  align-items: center; /* 垂直居中 */
}
#image-area img {
  object-fit: contain; /* 图片等比例缩放，保持宽高比 */
  width: 100%; /* 宽度自动调整 */
  height: 100%; /* 高度自动调整 */
  opacity: 1;
}
/* 全屏时的样式 */
#image-area:fullscreen {
  background-color: black; /* 背景黑色 */
}

</style>
</head>
<body>

<button id="select-button">选择图片</button>
<button id="fullscreen-button">全屏</button>
<button id="clear-button">清空</button>
<input type="number" id="interval-input" value="3" inputmode="numeric"> 秒
<div id="image-area"></div>

<script>
const selectButton = document.getElementById('select-button');
const fullscreenButton = document.getElementById('fullscreen-button');
const clearButton = document.getElementById('clear-button');
const intervalInput = document.getElementById('interval-input');
let intervalId = null;

const imageArea = document.getElementById('image-area');
let images = [];
let currentImageIndex = 0;

selectButton.addEventListener('click', () => {
  const input = document.createElement('input');
  input.type = 'file';
  input.multiple = true;
  input.accept = 'image/*';
  input.addEventListener('change', () => {
    images = Array.from(input.files);
    showImage(currentImageIndex);
  });
  input.click();
});

function showImage(index) {
  if (index < 0) {
    index = images.length - 1;
  } else if (index >= images.length) {
    if(images.length > 0){
      index = index % images.length; //循环播放
    } else{
      index = 0;
    }
  }
  if (images.length > 0) { // 检查是否有图片
    const reader = new FileReader();
    reader.onload = (event) => {
      imageArea.innerHTML = `<img src="${event.target.result}">`;
    };
    reader.readAsDataURL(images[index]);
  } else {
    imageArea.innerHTML = "请选择图片"; // 提示用户选择图片
  }
}

//切换图片
function startInterval() {
  if(intervalId!==null){
    clearInterval(intervalId);
  }
  const interval = parseInt(intervalInput.value) * 1000;
  intervalId = setInterval(() => {
    currentImageIndex++;
    showImage(currentImageIndex);
  }, interval);
}

intervalInput.addEventListener('change', startInterval);
startInterval();

// 全屏功能
fullscreenButton.addEventListener('click', () => {
  if (imageArea.requestFullscreen) {
    imageArea.requestFullscreen();
  } else if (imageArea.mozRequestFullScreen) { /* Firefox */
    imageArea.mozRequestFullScreen();
  } else if (imageArea.webkitRequestFullscreen) { /* Chrome, Safari and Opera */
    imageArea.webkitRequestFullscreen();
  } else if (imageArea.msRequestFullscreen) { /* IE/Edge */
    imageArea.msRequestFullscreen();
  }
});

clearButton.addEventListener('click', () => {
  images = [];
  showImage(currentImageIndex);
});

// 监听全屏事件，修改按钮文字
document.addEventListener('fullscreenchange', () => {
  if (document.fullscreenElement === imageArea) {
    fullscreenButton.textContent = "退出全屏";
  } else {
    fullscreenButton.textContent = "全屏";
  }
});

</script>

</body>
</html>